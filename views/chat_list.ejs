<%- include('partials/header_sidebar') %>

<style>
    .chat-list-container {
        max-width: 800px;
        margin: 0 auto;
        padding-top: 20px;
        padding-left: 15px;
        padding-right: 15px;
    }

    .chat-item {
        display: flex;
        align-items: center;
        padding: 12px 12px;
        border-bottom: 1px solid #e9ecef;
        transition: background-color 0.2s;
    }
    .chat-item:hover { background-color: #f8f9fa; }

    .chat-avatar {
        width: 55px;
        height: 55px;
        min-width: 55px;
        border-radius: 50%;
        object-fit: cover;
        border: 1px solid #dee2e6;
    }

    .chat-info {
        margin-left: 12px;
        flex: 1;
        min-width: 0;
    }

    .chat-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 4px;
        gap: 8px;
    }

    .chat-name {
        font-weight: 600;
        color: #212529;
        margin: 0;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
    }

    .chat-role {
        font-size: 0.75rem;
        background-color: #f8f9fa;
        color: #212529;
        border: 1px solid #dee2e6;
        padding: 2px 8px;
        border-radius: 20px;
        white-space: nowrap;
    }

    .chat-status {
        font-size: 0.85rem;
        color: #0d6efd;
        margin: 0;
    }

    .chat-arrow {
        color: #6c757d;
        font-size: 20px;
        flex-shrink: 0;
    }

    /* Mobile Responsiveness */
    @media (max-width: 575.98px) {
        .chat-list-container {
            padding-top: 15px;
            padding-left: 10px;
            padding-right: 10px;
        }

        .chat-item {
            padding: 10px 10px;
        }

        .chat-avatar {
            width: 48px;
            height: 48px;
        }

        .chat-info {
            margin-left: 10px;
        }

        .chat-name {
            font-size: 0.95rem;
        }

        .chat-role {
            font-size: 0.7rem;
            padding: 2px 6px;
        }

        .chat-status {
            font-size: 0.8rem;
        }

        .chat-arrow {
            font-size: 18px;
        }
    }
</style>

<div class="content-wrapper">
    <div class="chat-list-container">
        <h2 class="fw-bold mb-4" style="font-family: 'Cinzel';">Messages</h2>

        <div class="shadow-sm border-0 rounded-3" style="background-color: white; overflow: hidden;">
            <% if (chats.length > 0) { %>
                <% chats.forEach(chat => { %>
                    <a href="/chat/<%= chat.id %>" class="chat-item text-decoration-none">
                        <img src="<%= chat.profile_pic ? '/uploads/' + chat.profile_pic : 'https://via.placeholder.com/50' %>" 
                             class="chat-avatar"
                             alt="<%= chat.name %>">
                        <div class="chat-info">
                            <div class="chat-header">
                                <h6 class="chat-name"><%= chat.name %></h6>
                                <span class="chat-role"><%= chat.role.toUpperCase() %></span>
                            </div>
                            <p class="chat-status">Click to open chat</p>
                        </div>
                        <i class="bi bi-chevron-right chat-arrow"></i>
                    </a>
                <% }) %>
            <% } else { %>
                <div class="text-center py-5">
                    <i class="bi bi-chat-square-text fs-1 text-muted opacity-50"></i>
                    <p class="text-muted mt-2">No conversations yet.</p>
                </div>
            <% } %>
        </div>
    </div>
</div>

<%- include('partials/footer') %>